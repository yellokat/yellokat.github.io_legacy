---
title: "[DL Book] 7-1-1. Parameter Norm Penalties, L2 Regularization"
categories:
  - Deep Learning Book
tags:
  - Books
  - Deep Learning Book
  - Regularization
  - Statistics
  - Study Group
---

## 7.1.1. L2 íŒŒë¼ë¯¸í„° ì •ì¹™í™”

L2 íŒŒë¼ë¯¸í„° ì •ì¹™í™”ëŠ” ì •ì¹™í™” í•­ì„ **ëª¨ë¸ íŒŒë¼ë¯¸í„°ì— ëŒ€í•œ L2 ë…¸ë¦„ì˜ ì œê³±ì˜ ì ˆë°˜**ìœ¼ë¡œ ì‚¼ëŠ” ì „ëµìœ¼ë¡œ, ë”¥ëŸ¬ë‹ ì´ì „ì—ë„ **ë¦¿ì§€ íšŒê·€** í˜¹ì€ **í‹°í˜¸ë…¸í”„ ì •ì¹™í™”**ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì´ë¯¸ ë„ë¦¬ ì•Œë ¤ì¡Œë‹¤. í¸ì˜ë¥¼ ìœ„í•´ í¸í–¥ íŒŒë¼ë¯¸í„°ê°€ ì—†ëŠ” ëª¨ë¸ì˜ ëª©ì í•¨ìˆ˜ $J$ì™€ L2 ì •ì¹™í™”ê°€ ì ìš©ëœ ëª©ì í•¨ìˆ˜ $\hat{J}$ë¥¼ ìƒê°í•´ ë³´ì.

$$
\begin{align*}
\Omega(w)&=\color{red}\frac{1}{2}\|\|w\|\|^2_2\\
\tilde{J}(w;X,y)
&=J(w;X,y) + \color{red}\alpha(\frac{1}{2}\|\|w\|\|^2_2)\\
&=J(w;X,y) + \color{red}\frac{\alpha}{2}w^\text{T}w
\end{align*}
$$

ì´ ê²½ìš° íŒŒë¼ë¯¸í„° $w$ì— ëŒ€í•œ gradientëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì£¼ì–´ì§„ë‹¤.

$$
\nabla_w\tilde{J}(w;X,y)=\nabla_w J(w;X,y)+\color{red}\alpha w
$$

ê·¸ë ‡ë‹¤ë©´ í•™ìŠµë¥  $\epsilon$ê°€ ì£¼ì–´ì¡Œì„ ë•Œ ê° ë‹¨ê³„ì˜ ê°€ì¤‘ì¹˜ ê°±ì‹  ê·œì¹™ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
w \leftarrow w-\epsilon(\color{red}\alpha w\color{black}+\nabla_wJ(w;X,y))\\
w\leftarrow (1-\epsilon \color{red}\alpha\color{black})w-\epsilon\nabla_wJ(w;X,y)

$$

ì •ì¹™í™”ë¥¼ ì ìš©í•˜ì§€ ì•Šì€ ê°±ì‹  ê·œì¹™ê³¼ ë¹„êµí•´ ë³´ë©´ ê·¸ ì°¨ì´ê°€ í™•ì—°íˆ ë“œëŸ¬ë‚œë‹¤.

$$
\begin{align*}
w&\leftarrow \hspace{1.2cm} w-\epsilon\nabla_wJ(w;X,y)
&\hspace{0.5cm}\text{unregularized}\\
w&\leftarrow (1-\epsilon \color{red}\alpha\color{black})w-\epsilon\nabla_wJ(w;X,y)
&\text{L2 regularized}
\end{align*}
$$

ì¦‰ $\alpha$ëŠ” ê°€ì¤‘ì¹˜ê°€ ê°±ì‹ ë  ë•Œë§ˆë‹¤, gradientë¥¼ ì ìš©í•˜ê¸° ì§ì „ì— ê°€ì¤‘ì¹˜ì˜ í¬ê¸°ë¥¼ ì¤„ì—¬ ì£¼ëŠ” ì—­í• ì„ í•¨ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. **ì •í™•íˆëŠ” ì–‘ìˆ˜/ìŒìˆ˜ë¥¼ ë¶ˆë¬¸í•˜ê³  ê°€ì¤‘ì¹˜ì˜ ì ˆëŒ“ê°’ì„ ì‘ê²Œ ë§Œë“ ë‹¤.**

### í•˜ì´í¼íŒŒë¼ë¯¸í„° $\boldsymbol \alpha$ ê°’ì˜ ì¤‘ìš”ì„±

ì´ë²ˆì—ëŠ” $\boldsymbol w^*$ì—ì„œ ëª©ì í•¨ìˆ˜ $J(\theta)$ê°€ ìµœì†Ÿê°’ì„ ê°€ì§„ë‹¤ê³  ê°€ì •í•˜ê³ , í…Œì¼ëŸ¬ ê¸‰ìˆ˜ë¥¼ ì´ìš©í•´ $J(\theta)$ë¥¼ ë¶„í•´í•´ ë³´ì. í…Œì¼ëŸ¬ ê¸‰ìˆ˜ì˜ ì „ê°œëŠ” ë¬´í•œíˆ ê³„ì†ë  ìˆ˜ ìˆì§€ë§Œ 2ì°¨í•­ê¹Œì§€ë§Œ ì‚¬ìš©í•œë‹¤. ì´ê²ƒì„ Quadratic Approximationì´ë¼ê³  í•œë‹¤.

$$
\begin{align*}
f(x)&=\sum^n_{k=0}\frac{f^{(k)}(a)}{k!}(x-a)^k \hspace{3.5cm}\text{Taylor Expansion}\\
 &\approx f(a)+f'(a)(x-a)+\frac{1}{2!}f''(a)(x-a)^2+\color{lightgray}\frac{1}{3!}f'''(a)(x-a)^3 \cdots \\
\end{align*}
$$

ëª©ì í•¨ìˆ˜ $J(\theta)$ë¥¼, ìµœì†Ÿê°’ì„ ê°€ì§€ê²Œ í•˜ëŠ” ì§€ì  $\boldsymbol w^*$ì—ì„œ 2ì°¨ ë‹¤í•­í•¨ìˆ˜ë¡œ ê·¼ì‚¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. 

$$
\hat{J}(\theta)=J({\boldsymbol w}^*)+\color{lightgray}J'(\boldsymbol{w^*})(\boldsymbol{w}-\boldsymbol{w}^*)+\color{black}\frac{1}{2}(\boldsymbol{w}-\boldsymbol{w}^*)\boldsymbol{H}(\boldsymbol{w}-\boldsymbol{w}^*)
$$

2ì°¨ ë‹¤í•­í•¨ìˆ˜ ê·¼ì‚¬ì—ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ í•¨ìˆ˜ ì›í˜•ê³¼ 1ì°¨, 2ì°¨ ë„í•¨ìˆ˜ê°€ í¬í•¨ëœ í•­ì„ ë‚¨ê¸°ëŠ”ë°, ì •ì˜ìƒ $\boldsymbol{w}^\ast$ëŠ” ìµœì†Ÿê°’ì´ë¯€ë¡œ $\boldsymbol{w}^\ast$ì—ì„œì˜ 1ì°¨ ë„í•¨ìˆ˜ëŠ” 0ì´ ëœë‹¤. ë˜í•œ ìµœì†Ÿê°’ì´ ì¡´ì¬í•¨ì´ ì „ì œë˜ë¯€ë¡œ **$\boldsymbol H$ëŠ” Positive Semi-Definite**ì´ì–´ì•¼ í•œë‹¤.

ê·¸ëŸ¬ë©´ ê·¼ì‚¬ ëª©ì í•¨ìˆ˜ $\hat{J}(\theta)$ëŠ” ê·¸ ë¯¸ë¶„ì´ 0ì´ ë˜ëŠ” ê³³ì—ì„œ ìµœì†Ÿê°’ì„ ê°€ì§„ë‹¤. 

$$
\nabla_{\boldsymbol w}\hat{J}(\theta) = \boldsymbol{H}(\boldsymbol{w}-\boldsymbol{w}^*)=0
$$

ì—¬ê¸°ì„œ ì •ì¹™í™” í•­ $\Omega(\theta)=\frac{1}{2}\|\|\theta\|\|^2_2$ ë¥¼ ë„ì…í•œë‹¤ê³  ìƒê°í•´ ë³´ì. ê·¸ë ‡ë‹¤ë©´ ë°©ê¸ˆ ê³„ì‚°í•œ ë¯¸ë¶„ê°’ì— ì •ì¹™í™” í•­ì˜ ë¯¸ë¶„ê°’ì„ ë”í•´ì£¼ì–´ì•¼ í•œë‹¤. ê·¸ í›„, ìˆ˜ì‹ì„ 0ìœ¼ë¡œ ë§Œë“œëŠ” $\boldsymbol{w}$ë¥¼ ì°¾ìœ¼ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\boldsymbol{H}(\boldsymbol{w}-\boldsymbol{w}^*)+\color{red}\alpha\boldsymbol{w}\color{black}=0\\
(\boldsymbol{H}+\color{red}\alpha\boldsymbol{I}\color{black})\tilde{\boldsymbol{w}}=\boldsymbol{H}\boldsymbol{w}^*\\
\tilde{\boldsymbol{w}}=(\boldsymbol{H}+\color{red}\alpha\boldsymbol{I}\color{black})^{-1}\boldsymbol{H}\boldsymbol{w}^*
$$

ì—¬ê¸°ì„œ ìš°ì„ ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê²ƒì€, $\alpha$ê°€ 0ì— ë¬´í•œíˆ ê°€ê¹Œì›Œì§ˆìˆ˜ë¡ ì •ì¹™í™”ì˜ íš¨ê³¼ê°€ ì‚¬ë¼ì§€ë©°, ê²°êµ­ ì •ì¹™í™”ëœ ëª©ì í•¨ìˆ˜ì˜ ìµœì í™” í•´ëŠ” $\tilde{\boldsymbol{w}}=\boldsymbol{HH^{-1}}\boldsymbol{w}^*$ê°€ ë˜ì–´, ì •ì¹™í™”ë˜ì§€ ì•Šì€ ëª©ì í•¨ìˆ˜ì˜ ìµœì†Ÿê°’ìœ¼ë¡œ ì •ì˜ëœ $\boldsymbol{w}^*$ ì™€ ê°™ì•„ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤.

### í•˜ì´í¼íŒŒë¼ë¯¸í„° $\boldsymbol \alpha$ ê°’ì˜ ì˜ë¯¸

ê³„ì†í•´ì„œ $\boldsymbol{H}$ëŠ” í—¤ì‹œì•ˆ í–‰ë ¬ë¡œ ëŒ€ì¹­í–‰ë ¬ì´ë©°, ê³ ìœ³ê°’ ë¶„í•´ê°€ ê°€ëŠ¥í•˜ë‹¤. $\boldsymbol{H=Q\Lambda Q}^{\text{T}}$ë¡œ ê³ ìœ³ê°’ ë¶„í•´ë¥¼ ì§„í–‰í•˜ê³  ìˆ˜ì‹ì„ ì •ë¦¬í•˜ë©´,

$$
\begin{align*}
\boldsymbol{\tilde{w}}&=(\boldsymbol{Q\Lambda Q}^{\text{T}}+\alpha\boldsymbol{I})^{-1}\boldsymbol{Q\Lambda Q}^{\text{T}}\boldsymbol{w}^*\\
&=\bigg[\boldsymbol{Q(\Lambda}+\alpha {\boldsymbol I}) \boldsymbol{Q}^{\text{T}}\bigg]^{-1}\boldsymbol{Q\Lambda Q}^{\text{T}}\boldsymbol{w}^*\\
&=\color{blue}\boldsymbol{Q\color{green} (\Lambda}\color{green}+\alpha{\boldsymbol I})^{-1} {\boldsymbol \Lambda} \color{blue}{\boldsymbol Q}^{\text{T}}\color{black}\boldsymbol{w}^*
\end{align*}
$$

ê³ ìœ³ê°’ ë¶„í•´ì˜ $\boldsymbol{\color{blue}Q\color{green}\Lambda \color{blue}Q^{-1}}$ì˜ ê° í–‰ë ¬ì€ ê°ê° **íšŒì „â†’í¬ê¸°ë³€í™˜â†’íšŒì „**ì˜ ê³¼ì •ì„ ë‚˜íƒ€ë‚¸ ê²ƒìœ¼ë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì—ì„œ L2 ì •ì¹™í™”ì˜ íš¨ê³¼ë¥¼ ì—¿ë³¼ ìˆ˜ ìˆë‹¤. 

<aside>
ğŸ’¡ **ìì„¸íˆ ë³´ê¸°**

- **L2 ì •ì¹™í™”ë¥¼ ì ìš©í•˜ë©´ ê¸°ì¡´ ìµœì í™” í•´ $\boldsymbol w^*$ê°€ ìƒˆë¡œìš´ ì  $\tilde{\boldsymbol w}$ë¡œ ì´ë™í•œë‹¤.**
    - ê¸°ì¡´ ìµœì í™” í•´ $\boldsymbol w^*$ëŠ” $\boldsymbol H$ì˜ ê³ ìœ ë²¡í„°ì˜ ë°©í–¥ìœ¼ë¡œ ì„ í˜•ë³€í™˜ë˜ë©°, ê·¸ í¬ê¸°ê°€ ì¡°ì ˆë˜ëŠ” ì •ë„ëŠ” $\boldsymbol H$ì˜ ê³ ìœ³ê°’ë“¤ê³¼ ì—°ê´€ì´ ìˆë‹¤.
    - L2 ì •ì¹™í™”ë¥¼ ì‹œí–‰í•˜ë©´ ê³ ìœ³ê°’ë“¤ì— $\alpha$ë§Œí¼ì˜ ìƒìˆ˜ê°€ ë”í•´ì§„ë‹¤. ë”°ë¼ì„œ,
        - $\alpha$ë³´ë‹¤ ì‘ì€ ê³ ìœ³ê°’ë“¤ì€ ê·¸ë§Œí¼ ì˜í–¥ì„ ë§ì´ ë°›ëŠ”ë‹¤. ì¦‰ í•´ë‹¹ ê³ ìœ ë²¡í„° ë°©í–¥ìœ¼ë¡œëŠ” í° ë³€í™˜ì´ ì¼ì–´ë‚œë‹¤.
        - $\alpha$ë³´ë‹¤ í° ê³ ìœ³ê°’ë“¤ì€ ë¹„êµì  ì˜í–¥ì„ ëœ ë°›ëŠ”ë‹¤. ì¦‰ í•´ë‹¹ ê³ ìœ ë²¡í„° ë°©í–¥ìœ¼ë¡œëŠ” ì‘ì€ ë³€í™˜ë§Œì´ ì¼ì–´ë‚œë‹¤.
</aside>

### L2 ì •ì¹™í™”ì˜ ê¸°í•˜í•™ì  ì˜ë¯¸

![Untitled](/assets/images/7-1-1a.png)

ìœ„ ê·¸ë¦¼ì—ì„œ $\boldsymbol w^*$ëŠ” ì›ë³¸ ëª©ì í•¨ìˆ˜ $J$ë¥¼ ìµœì†Œí™”ì‹œí‚¤ëŠ” ì§€ì ì´ê³ , ì›ì  $(0, 0)$ì€ ì •ì¹™í™” í•­ $\alpha \times \frac{1}{2}||\boldsymbol w||^2_2$ ë¥¼ ìµœì†Œí™”ì‹œí‚¤ëŠ” ì§€ì ì´ë‹¤. L2 ì •ì¹™í™”ëœ ëª©ì í•¨ìˆ˜ $\hat{J}$ëŠ” ì–‘ìª½ ëª¨ë‘ë¥¼ ìµœì†Œí™”ì‹œì¼œì•¼ í•˜ë¯€ë¡œ, ë‘ í•¨ìˆ˜ê°€ ì ì  ë°”ê¹¥ìœ¼ë¡œ ë»—ì–´ë‚˜ê°€ë‹¤ê°€ ë§Œë‚˜ëŠ” ì§€ì ì—ì„œ ìµœì†Ÿê°’ì„ ê°€ì§€ê²Œ ëœë‹¤.